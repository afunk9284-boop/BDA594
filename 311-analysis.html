<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>311 Report Analysis · Weather, Policy, and Topic Modeling of 311 Reports on Homelessness in San Diego</title>
  <meta name="description" content="Methods and findings from 311 reports text analysis."/>
  <meta name="theme-color" content="#ffffff" />
  <link rel="stylesheet" href="assets/style.css"/>
  <style>
    body {
      background: #f5f5f5;
      color: #111;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    .viz-container {
      margin-top: 1.5rem;
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 8px;
      background: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.04);
      padding: 1rem;
    }
    .viz-caption {
      margin-top: .5rem;
      color: #555;
      font-size: .9rem;
    }
  </style>
</head>
<body>
  
<header class="site">
  <div class="container nav">
    <div class="brand">
      <span class="brand-badge" aria-hidden="true"></span>
      <span>Weather, Policy, & Topic Modeling (San Diego)</span>
    </div>
    <nav class="navlinks" aria-label="Primary">
      <a href="index.html">Home</a><a href="about.html">About</a><a href="311-analysis.html">311 Analysis</a><a href="migration.html">Encampment Migration</a><a href="weather.html">Weather</a><a href="policy.html">Policy</a><a href="conclusion.html">Conclusion</a><a href="data.html">Data Description</a><a href="team.html">Team</a>
    </nav>
  </div>
</header>

<main>
  <section class="container">
    <div role="region" aria-label="Page title">
      <h1>311 Report Analysis · Weather, Policy, and Topic Modeling of 311 Reports on Homelessness in San Diego</h1>
      <p class="subtitle">Methods and findings from 311 reports text analysis.</p>
    </div>

    <article class="panel">
      <h2>311 Report Analysis</h2>
      <p>Text preprocessing, topic modeling approach (e.g., LDA / BERTopic), validation, and interpretation of homelessness-related themes.</p>
    </article>

    <!-- Inline Heatmap Section -->
    <article class="panel viz-container">
      <h2>Interactive Topic Heatmap</h2>

      <!-- BEGIN INLINE HEATMAP -->
      <div style="max-width:1030px; width:100%; margin:0 auto">
        <div id="topic_heat_light" class="plotly-graph-div" style="height:280px;" role="img" aria-label="Monthly activity interactive topic heatmap"></div>
      </div>

      <div id="topic_heat_panel_light" style="
        background: rgba(255,255,255,0.18);
        color:#111;
        border:1px solid rgba(200,200,200,0.35);
        padding:8px;
        max-height:260px;
        overflow:auto;
        margin-top:6px;
        backdrop-filter: blur(12px);
        border-radius:8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      ">
        <b>Cell details</b> (click a square above)
      </div>

      <!-- Load Plotly -->
      <script src="https://cdn.plot.ly/plotly-3.1.1.min.js"
              integrity="sha256-HUEFyfiTnZJxCxur99FjbKYTvKSzwDaD3/x5TqHpFu4="
              crossorigin="anonymous" defer></script>

      <!-- Plot + click handler -->
      <script>
        // Full dataset of descriptions (descMap)
        const descMap = {
          // Paste your JSON mapping here, e.g. "2|2024-03": ["Sample desc 1","Sample desc 2"]
        };

        window.addEventListener('DOMContentLoaded', function () {
          // === Your Plotly.newPlot call goes here ===
          // Replace below with your actual figure data & layout from topic_heatmap_offline.html
          // Example:
          // Plotly.newPlot("topic_heat_light", tracesArray, layoutObject, {responsive:true});

          const g = document.getElementById('topic_heat_light');
          const panel = document.getElementById('topic_heat_panel_light');

          if (!g) return;

          // Click → show descriptions
          g.on('plotly_click', function (ev) {
            const pt = ev.points && ev.points[0];
            if (!pt) return;
            const month = pt.x;
            const topicKey = (pt.data.name || '').trim();
            const mapKey = topicKey + '|' + month;
            const samples = descMap[mapKey] || [];
            const binLabel = Array.isArray(pt.data.text)
              ? pt.data.text[pt.pointNumber]
              : pt.text;
            panel.innerHTML = `
              <h4 style="margin:0 0 6px 0;">${pt.y} — ${month} • ${samples.length} item(s)</h4>
              ${
                !samples.length
                  ? '<div style="color:#666">No descriptions for this cell.</div>'
                  : '<ul style="padding-left:18px;margin:0;">' +
                    samples.map(s => '<li>' + s + '</li>').join('') +
                    '</ul>'
              }
            `;
          });
        });
      </script>
      <!-- END INLINE HEATMAP -->

      <p class="viz-caption">
        Tip: click any square to see that month’s sample report texts for the selected topic.
      </p>
    </article>
  </section>
</main>
  
<footer>
  <div class="container foot"><small>© <span id="y"></span> Project Site</small></div>
</footer>
<script src="assets/site.js"></script>

</body>
</html>
